#pragma once

#include <cstdint>

/**
 * @defgroup registry_types Типы данных реестра
 * @brief Основные структуры и типы данных для работы с реестром Windows
 */

/**
 * @ingroup registry_types
 * @brief Типы данных значений реестра
 * @details Стандартные типы данных, используемые в системном реестре Windows
 */
enum class ValueType {
  REG_NONE,  ///< Пустое значение или отсутствие данных
  REG_SZ,  ///< Строковое значение в кодировке UTF-16LE (с нулевым завершителем)
  REG_DWORD,  ///< 32-битное целое число (Little-Endian)
  REG_BINARY  ///< Произвольные бинарные данные
};

/**
 * @ingroup registry_types
 * @brief Структура узла ключа реестра
 * @details Содержит метаинформацию о разделе реестра. 
 * Размер и выравнивание структуры строго фиксированы для совместимости 
 * с бинарным форматом системного реестра.
 */
struct [[gnu::packed]] KeyNode {
  uint32_t offset;         ///< Абсолютное смещение ключа в файле (в байтах)
  uint32_t subkeys_count;  ///< Количество дочерних подразделов
  uint32_t values_count;   ///< Количество значений в разделе
  uint32_t last_modified;  ///< Время последнего изменения (UNIX timestamp)
};

/**
 * @ingroup registry_types
 * @brief Структура записи значения реестра
 * @details Описывает метаданные значения реестра, включая расположение
 * данных в файле. Все смещения указаны относительно начала файла.
 */
struct [[gnu::packed]] ValueEntry {
  ValueType type;        ///< Тип хранимых данных (из перечисления ValueType)
  uint32_t data_offset;  ///< Смещение данных значения (в байтах)
  uint32_t data_size;    ///< Размер данных значения (в байтах)
  uint16_t name_length;  ///< Длина имени значения в символах UTF-16
  uint32_t name_offset;  ///< Смещение имени значения (в байтах)
};
